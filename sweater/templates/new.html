{% extends "base.html" %}

{% block body %}
        <div class="news">
            {% if username == new.author.login %}
            <p> Пользователь: Вы</p>
            {% else %}
            <p> Пользователь: {{ new.author.login }}</p>
            {% endif %}
            
            <p>{{ new.title }}</p>
            <p>{{ new.text }}</p>
            {% if new.media_path %}
                {% set relative_path = new.media_path.split('flask_socialnet/')[-1].replace('\\', '/') %}
                <img class="novost_img" src="{{ url_for('static', filename=relative_path) }}" alt="Изображение новости">
            {% endif %}
            {% if username == new.author.login %}
            <form action="{{ url_for('delete_news', news_id=new.id) }}" method="post" style="display:inline;">
                <button type="submit" onclick="return confirm('Вы уверены, что хотите удалить эту новость?');">Удалить</button>
            </form>
            <form action="{{ url_for('upgrade_news', news_id=new.id) }}" method="get" style="display:inline;">
                <button type="submit">Редактировать</button>
            </form>
            {% endif %}
            <form method="POST">
                <textarea name="comment" required></textarea>
                <button type="submit">Добавить комментарий</button>
            </form>
            <div>
                <h2>Комментарии:</h2>
                <ul>
                    {% for comment in comments %}
                    <li>{{ comment.text }} ({{ comment.created_at.strftime('%Y-%m-%d %H:%M') }})</li>
                    {% endfor %}
                </ul>
            </div>

        </div>
{% endblock %}